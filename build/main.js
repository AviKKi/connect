var $_inter,blueball=!1,redball=!1,deletewall=!1,keyActions={37:"left",38:"up",39:"right",40:"down",35:"space"},canvas=document.getElementById("canvas"),ctx=canvas.getContext("2d"),width=canvas.width,height=canvas.height,blocksize=10,body=document.getElementById("body"),walkersmsg="Oops White Walkers",walke=!1,drawBorder=function(){ctx.fillStyle="grey",ctx.fillRect(0,0,width,blocksize),ctx.fillRect(0,height-blocksize,width,blocksize),ctx.fillRect(0,0,blocksize,height),ctx.fillRect(width-blocksize,0,blocksize,height)},circle=function(e,t,i,l,r){ctx.beginPath(),ctx.arc(e,t,i,0,2*Math.PI,!1),r&&(ctx.fillStyle=l,ctx.fill())},Ball=function(){},startScreen=function(){ctx.clearRect(0,0,600,600),ctx.fillStyle="#FFF",ctx.textAlign="center",ctx.font="40px Serif",ctx.fillText("Connect",width/2,height/3),ctx.font="30px Serif",ctx.fillText("Press Space to Start",width/2,height/2)};Ball.prototype.draw=function(e,t,i){e-=5,t-=4,ctx.strokeStyle=i,ctx.strokeRect(e,t,6,10),ctx.fillStyle=i,ctx.fillRect(e+6,t+3,14,2),ctx.fillRect(e+11,t+3,2,6),ctx.fillRect(e+16,t+3,2,9)},Ball.prototype.checkcollision=function(){computer.x>=120&&computer.x<=140&&computer.y>=10&&computer.y<=30&&(blueball=!0,deletewall=!0,computer.xspeed=-5,computer.yspeed=-5,internet.xspeed=-5,internet.yspeed=-5),internet.x>=520&&internet.x<=555&&internet.y>=550&&internet.y<=570&&(redball=!0,computer.xspeed=5,computer.yspeed=5,internet.xspeed=5,internet.yspeed=5)};var Comp=function(){this.x=width-blocksize-20,this.y=height-blocksize-20,this.xspeed=5,this.yspeed=5},Intern=function(){this.x=blocksize,this.y=blocksize,this.xspeed=5,this.yspeed=5},Enemycomp=function(){this.x=width/2,this.y=blocksize,this.xspeed=5,this.yspeed=5},Enemyintern=function(){this.x=width/2,this.y=height-blocksize-20,this.xspeed=5,this.yspeed=5};Enemycomp.prototype.draw=function(){ctx.fillStyle="white",ctx.fillRect(this.x,this.y,20,20)},Enemyintern.prototype.draw=function(){ctx.fillStyle="white",ctx.fillRect(this.x,this.y,20,20)},Enemycomp.prototype.move=function(e){"up"==e?this.y-=this.yspeed:"down"==e?this.y+=this.yspeed:"left"==e?this.x-=this.xspeed:"right"==e&&(this.x+=this.xspeed),this.x<blocksize?this.x=blocksize:this.x>width-blocksize-20?this.x=width-blocksize-20:this.y<blocksize?this.y=blocksize:this.y>height-blocksize-20&&(this.y=height-blocksize-20)},Enemyintern.prototype.move=function(e){"up"==e?this.y+=this.yspeed:"down"==e?this.y-=this.yspeed:"left"==e?this.x+=this.xspeed:"right"==e&&(this.x-=this.xspeed),this.x<blocksize?this.x=blocksize:this.x>width-blocksize-20?this.x=width-blocksize-20:this.y<blocksize?this.y=blocksize:this.y>height-blocksize-20&&(this.y=height-blocksize-20)},Comp.prototype.draw=function(e){ctx.strokeStyle="white",ctx.strokeRect(this.x,this.y,20,16),ctx.strokeStyle="grey",ctx.strokeRect(this.x+2,this.y+2,16,12),ctx.fillStyle="green",ctx.fillRect(this.x+3,this.y+5,3,3),ctx.fillRect(this.x+7.5,this.y+5,5,3),ctx.fillStyle="white",ctx.fillRect(this.x+5,this.y+16,10,4)},Intern.prototype.draw=function(e){ctx.strokeStyle="blue",ctx.strokeRect(this.x,this.y,20,20),ctx.lineWidth=3,ctx.strokeStyle="blue",ctx.beginPath(),ctx.arc(this.x+10,this.y+12.5,3,0,Math.PI,!0),ctx.stroke(),ctx.beginPath(),ctx.arc(this.x+10,this.y+11,7,0,Math.PI,!0),ctx.stroke(),circle(this.x+10,this.y+16,2,"blue",!0)},Comp.prototype.move=function(e){"up"==e?this.y-=this.yspeed:"down"==e?this.y+=this.yspeed:"left"==e?this.x-=this.xspeed:"right"==e&&(this.x+=this.xspeed),this.x<blocksize?this.x=blocksize:this.x>width-blocksize-20?this.x=width-blocksize-20:this.y<blocksize?this.y=blocksize:this.y>height-blocksize-20&&(this.y=height-blocksize-20)},Intern.prototype.move=function(e){"up"==e?this.y+=this.yspeed:"down"==e?this.y-=this.yspeed:"left"==e?this.x+=this.xspeed:"right"==e&&(this.x-=this.xspeed),this.x<blocksize?this.x=blocksize:this.x>width-blocksize-20?this.x=width-blocksize-20:this.y<blocksize?this.y=blocksize:this.y>height-blocksize-20&&(this.y=height-blocksize-20)},Comp.prototype.checkcollision=function(e,t,i,l,r){this.x-2<e+i&&this.x+25>e&&this.y-2<t+l&&25+this.y>t&&gameover(r)},Comp.prototype.collision=function(e){this.x-2<walk.x+30&&this.x+25>walk.x&&this.y-2<walk.y+160&&25+this.y>walk.y&&gameover(e),this.x-2<walk2.x+30&&this.x+25>walk2.x&&this.y-2<walk2.y+160&&25+this.y>walk2.y&&gameover(e),this.x-2<walk3.x+30&&this.x+25>walk3.x&&this.y-2<walk3.y+175&&25+this.y>walk3.y&&gameover(e)},Intern.prototype.checkcollision=function(e,t,i,l,r){this.x-2<e+i&&this.x+25>e&&this.y-2<t+l&&25+this.y>t&&gameover(r)},Intern.prototype.collision=function(e){this.x-2<walk.x+30&&this.x+25>walk.x&&this.y-2<walk.y+160&&25+this.y>walk.y&&gameover(e),this.x-2<walk2.x+30&&this.x+25>walk2.x&&this.y-2<walk2.y+160&&25+this.y>walk2.y&&gameover(e),this.x-2<walk3.x+30&&this.x+25>walk3.x&&this.y-2<walk3.y+175&&25+this.y>walk3.y&&gameover(e)},Enemycomp.prototype.checkcollision=function(e){this.x<computer.x+20&&this.x+20>computer.x&&this.y<computer.y+20&&20+this.y>computer.y&&(walke=!0,gameover(e)),this.x<internet.x+20&&this.x+20>internet.x&&this.y<internet.y+20&&20+this.y>internet.y&&(walke=!0,gameover(e)),this.x<enemyr.x+20&&this.x+20>enemyr.x&&this.y<enemyr.y+20&&20+this.y>enemyr.y&&(walke=!0,gameover(e))},Enemyintern.prototype.checkcollision=function(e){this.x<computer.x+20&&this.x+20>computer.x&&this.y<computer.y+20&&20+this.y>computer.y&&(walke=!0,gameover(e)),this.x<internet.x+20&&this.x+20>internet.x&&this.y<internet.y+20&&20+this.y>internet.y&&(walke=!0,gameover(e)),this.x<enemyb.x+20&&this.x+20>enemyb.x&&this.y<enemyb.y+20&&20+this.y>enemyb.y&&(walke=!0,gameover(e))},Enemycomp.prototype.wallcollision=function(e,t,i,l,r){this.x-2<e+i&&this.x+25>e&&this.y-2<t+l&&25+this.y>t&&(walke=!0,gameover(r))},Enemycomp.prototype.collision=function(e){this.x-2<walk.x+30&&this.x+25>walk.x&&this.y-2<walk.y+160&&25+this.y>walk.y&&(walke=!0,gameover(e)),this.x-2<walk2.x+30&&this.x+25>walk2.x&&this.y-2<walk2.y+160&&25+this.y>walk2.y&&(walke=!0,gameover(e)),this.x-2<walk3.x+30&&this.x+25>walk3.x&&this.y-2<walk3.y+175&&25+this.y>walk3.y&&(walke=!0,gameover(e))},Enemyintern.prototype.wallcollision=function(e,t,i,l,r){this.x-2<e+i&&this.x+25>e&&this.y-2<t+l&&25+this.y>t&&(walke=!0,gameover(r))},Enemyintern.prototype.collision=function(e){this.x-2<walk.x+30&&this.x+25>walk.x&&this.y-2<walk.y+160&&25+this.y>walk.y&&(walke=!0,gameover(e)),this.x-2<walk2.x+30&&this.x+25>walk2.x&&this.y-2<walk2.y+160&&25+this.y>walk2.y&&(walke=!0,gameover(e)),this.x-2<walk3.x+30&&this.x+25>walk3.x&&this.y-2<walk3.y+175&&25+this.y>walk3.y&&(walke=!0,gameover(e))};var Dangerwall=function(){},Walkwall=function(){this.x=80,this.y=70,this.xspeed=3};Walkwall.prototype.draw=function(){ctx.strokeStyle="green",ctx.lineWidth=1,ctx.strokeRect(this.x,this.y,30,160)},Walkwall.prototype.move=function(){this.x+=this.xspeed,(this.x<80||this.x>250)&&(this.xspeed=-this.xspeed)};var Walkwall2=function(){this.x=480,this.y=380,this.xspeed=-3};Walkwall2.prototype.draw=function(){ctx.strokeStyle="green",ctx.lineWidth=1,ctx.strokeRect(this.x,this.y,30,160)},Walkwall2.prototype.move=function(){this.x+=this.xspeed,(this.x>480||this.x<315)&&(this.xspeed=-this.xspeed)};var Walkwall3=function(){this.x=480,this.y=70,this.xspeed=-5};Walkwall3.prototype.draw=function(){ctx.strokeStyle="green",ctx.lineWidth=1,ctx.strokeRect(this.x,this.y,30,175)},Walkwall3.prototype.move=function(){this.x+=this.xspeed,(this.x>480||this.x<315)&&(this.xspeed=-this.xspeed)},Dangerwall.prototype.draw=function(e,t,i,l,r){ctx.strokeStyle=r,ctx.lineWidth=1,ctx.strokeRect(e,t,i,l);for(var a=t+10;a<t+l;a+=10)ctx.beginPath(),ctx.moveTo(e,a),ctx.lineTo(e+i,a),ctx.stroke();for(var a=0;a<l/10;a++)for(var n=20*(a%2==0?.5:1)+e;n<e+i;n+=20)ctx.beginPath(),ctx.moveTo(n,t+10*a),ctx.lineTo(n,t+10*(a+1)),ctx.stroke()};var gameoverState=!0,walk=new Walkwall,walk2=new Walkwall2,walk3=new Walkwall3,ball=new Ball,computer=new Comp,internet=new Intern,wall=new Dangerwall,enemyb=new Enemycomp,enemyr=new Enemyintern,firstRun=!0,bodyy=document.getElementById("body");bodyy.onkeydown=function(e){if(32==e.keyCode)firstRun?(firstRun=!1,showManual()):gameoverState&&currentLevel();else{var t=keyActions[e.keyCode];computer.move(t),internet.move(t),enemyb.move(t),enemyr.move(t)}};var gameover=function(e){clearInterval(e),gameoverState=!0,ctx.font="35px Serif",ctx.fillStyle="red",ctx.textAlign="center",ctx.textBaseline="middle",1==walke?ctx.fillText(walkersmsg,width/2,height/2):ctx.fillText("Oops Burned In Firewall!!! :(",width/2,height/2),ctx.font="26px Serif",ctx.fillText("Gameover :(",width/2,height/2+50),ctx.font="20px Serif",ctx.fillStyle="white",ctx.fillText("Press space to restart :)",width/2,height/2+80)},manualId=1,typeWritterWrite=function(e,t,i,l,r){"use strict";var a=t||0,n=i||0,l=l||32;r=r||10;var o=0;$_inter=setInterval(function(){var i=e.substr(o),c=i.indexOf(" ");c=-1===c?e.length:c;var s=ctx.measureText(i.substring(0,c)).width,h=ctx.measureText(e.charAt(o)).width;a+s>=canvas.width-r&&(a=t,n+=l),ctx.fillText(e.charAt(o),a,n),o++,a+=h},30)},showManual=function(){"use strict";switch(manualId){case 1:var e="DAY-1 : Silly Sam(my colleague) has again run some fisky commands on my work computer, please help me to connect to network, find your way through firewalls.";break;case 2:var e="DAY-2 : Silly Sam is learning authentication managment, he created a nice authentication program for me but I lost the keys. Please find all the keys and connect to the network,(you'll discover some of his anti-trespassing code along your way).";break;case 3:var e="DAY-3 : Silly Sam is very influenced by Game of Thrones series, he has made some AI white walkers, stay away from them and don't trigger firewalls(white walkers are not that intelligent ;)";break;case 4:var e="DAY-4 : Silly Sam is done with TV series and is into advanced security firewalls.";break;case 5:var e="DAY-5 : Sadly Silly Sam is resigning from his job, so he made one last master piece to keep me busy for several days."}ctx.clearRect(0,0,600,600),ctx.fillStyle="green",ctx.textAlign="left",ctx.font="24px sans-serif",typeWritterWrite(e,10,30,32,10),gameoverState=!0},level1=function(){clearInterval($_inter),gameoverState=!1,computer.x=width-blocksize-20,internet.x=blocksize,computer.y=height-blocksize-20,internet.y=blocksize,manualId=2,arrayp=[[80,50,30,160],[width-blocksize-100,height-blocksize-150,30,150],[170,220,30,160],[400,330,30,160],[285,200,30,80],[285,320,30,80],[225,420,30,80],[330,220,90,30],[80,380,30,160],[130,80,80,30],[135,540,80,30],[width-blocksize-100,50,30,160]],IntervalId=setInterval(function(){ctx.clearRect(0,0,width,height),drawBorder(),ctx.font="20px Courier",ctx.fillStyle="Yellow",ctx.textAlign="center",ctx.textBaseline="middle",ctx.fillText("Day-1",290,30),computer.draw("blue"),internet.draw("red");for(var e=0;e<arrayp.length;e++)wall.draw(arrayp[e][0],arrayp[e][1],arrayp[e][2],arrayp[e][3],"green");for(var e=0;e<arrayp.length;e++)computer.checkcollision(arrayp[e][0],arrayp[e][1],arrayp[e][2],arrayp[e][3],IntervalId),internet.checkcollision(arrayp[e][0],arrayp[e][1],arrayp[e][2],arrayp[e][3],IntervalId);computer.x==internet.x&&computer.y==internet.y&&(clearInterval(IntervalId),ctx.font="bold 35px Courier",ctx.fillStyle="white",ctx.textAlign="center",ctx.textBaseline="middle",ctx.fillText("Well Done!!",width/2,height/2-120),setTimeout(function(){showManual(),currentLevel=level2},2500)),ctx.strokeRect(0,0,width,height)},30)},currentLevel=level1,level2=function(){clearInterval($_inter),manualId=3,gameoverState=!1,currentLevel=level2,clearInterval(IntervalId),computer.x=width-blocksize-20,computer.xspeed=5,computer.yspeed=5,internet.xspeed=5,internet.yspeed=5,internet.x=blocksize,computer.y=height-blocksize-20,internet.y=blocksize,blueball=!1,redball=!1,deletewall=!1,arrayp=[[80,50,30,160],[width-blocksize-100,height-blocksize-150,30,150],[170,220,30,160],[400,330,30,160],[285,200,30,80],[285,320,30,80],[225,420,30,80],[330,220,90,30],[80,380,30,160],[135,540,80,30],[width-blocksize-100,50,30,160]],IntervalId2=setInterval(function(){ctx.clearRect(0,0,width,height),drawBorder(),ctx.font="20px Courier",ctx.fillStyle="Yellow",ctx.textAlign="center",ctx.textBaseline="middle",ctx.fillText("Day-2",290,30),computer.draw("blue"),internet.draw("red"),0==blueball&&(ball.draw(125,25,"white"),ball.checkcollision()),0==redball&&(ball.draw(width-blocksize-50,height-blocksize-15,"blue"),ball.checkcollision());for(var e=0;e<arrayp.length;e++)wall.draw(arrayp[e][0],arrayp[e][1],arrayp[e][2],arrayp[e][3],"green");0==deletewall&&(wall.draw(130,80,80,30,"green"),computer.checkcollision(130,80,80,30,IntervalId2),internet.checkcollision(130,80,80,30,IntervalId2));for(var e=0;e<arrayp.length;e++)computer.checkcollision(arrayp[e][0],arrayp[e][1],arrayp[e][2],arrayp[e][3],IntervalId2),internet.checkcollision(arrayp[e][0],arrayp[e][1],arrayp[e][2],arrayp[e][3],IntervalId2);computer.x==internet.x&&computer.y==internet.y&&1==blueball&&1==redball&&(clearInterval(IntervalId2),ctx.font="bold 35px Courier",ctx.fillStyle="white",ctx.textAlign="center",ctx.textBaseline="middle",ctx.fillText("Good work!!",width/2,height/2-120),ctx.fillText("Stealing the keys.",width/2,height/2+45-120),setTimeout(function(){showManual(),currentLevel=level3},2500)),ctx.strokeRect(0,0,width,height)},30)},level3=function(){clearInterval($_inter),manualId=4,currentLevel=level3,gameoverState=!1;var e=[[80,50,30,160],[width-blocksize-100,height-blocksize-150,30,150],[width-blocksize-100,50,30,150],[285,200,30,80],[285,320,30,80],[220,260,30,80],[350,260,30,80],[80,350,30,160],[340,180,80,30]];clearInterval(IntervalId2),walke=!1,enemyb.x=width/2,enemyb.y=blocksize,enemyr.x=width/2,enemyr.y=height-blocksize-20,computer.x=blocksize,internet.x=width-blocksize-20,computer.y=blocksize,internet.y=height-blocksize-20,IntervalId3=setInterval(function(){ctx.clearRect(0,0,width,height),drawBorder(),ctx.font="20px Courier",ctx.fillStyle="Yellow",ctx.textAlign="center",ctx.textBaseline="middle",ctx.fillText("Day-3",290,30),computer.draw("blue"),enemyb.draw(),enemyb.checkcollision(IntervalId3),internet.draw("red"),enemyr.draw(),enemyr.checkcollision(IntervalId3);for(var t=0;t<e.length;t++)wall.draw(e[t][0],e[t][1],e[t][2],e[t][3],"green");for(var t=0;t<e.length;t++)enemyb.wallcollision(e[t][0],e[t][1],e[t][2],e[t][3],IntervalId3),enemyr.wallcollision(e[t][0],e[t][1],e[t][2],e[t][3],IntervalId3);for(var t=0;t<e.length;t++)computer.checkcollision(e[t][0],e[t][1],e[t][2],e[t][3],IntervalId3),internet.checkcollision(e[t][0],e[t][1],e[t][2],e[t][3],IntervalId3);computer.x==internet.x&&computer.y==internet.y&&(clearInterval(IntervalId3),ctx.font="bold 35px Courier",ctx.fillStyle="white",ctx.textAlign="center",ctx.textBaseline="middle",ctx.fillText("Congrats!!",width/2,height/2-120),ctx.fillText("You survived the winters!!",width/2,height/2+45-120),setTimeout(function(){showManual(),currentLevel=level4},2500)),ctx.strokeRect(0,0,width,height)},30)},level4=function(){manualId=5,clearInterval($_inter),currentLevel=level4,gameoverState=!1,array=[[100,270,30,80],[470,270,30,80],[240,250,120,20],[240,340,120,20]],enemyb.x=width/2,enemyb.y=height-blocksize-20,enemyr.x=width/2,enemyr.y=blocksize,computer.x=width-blocksize-20,internet.x=blocksize,computer.y=height-blocksize-20,internet.y=blocksize,clearInterval(IntervalId3),walke=!1,IntervalId4=setInterval(function(){ctx.clearRect(0,0,width,height),drawBorder(),computer.draw("blue"),internet.draw("red"),computer.collision(IntervalId4),internet.collision(IntervalId4),ctx.strokeRect(0,0,width,height),ctx.font="20px Courier",ctx.fillStyle="Yellow",ctx.textAlign="center",ctx.textBaseline="middle",ctx.fillText("Day-4",290,30),enemyb.draw(),enemyb.checkcollision(IntervalId4),enemyr.draw(),enemyr.checkcollision(IntervalId4);for(var e=0;e<array.length;e++)enemyb.wallcollision(array[e][0],array[e][1],array[e][2],array[e][3],IntervalId4),enemyr.wallcollision(array[e][0],array[e][1],array[e][2],array[e][3],IntervalId4),enemyb.collision(IntervalId4),enemyr.collision(IntervalId4);walk.draw(),walk.move(),walk2.draw(),walk2.move(),walk3.draw(),walk3.move();for(var e=0;e<array.length;e++)wall.draw(array[e][0],array[e][1],array[e][2],array[e][3],"green");for(var e=0;e<array.length;e++)computer.checkcollision(array[e][0],array[e][1],array[e][2],array[e][3],IntervalId4),internet.checkcollision(array[e][0],array[e][1],array[e][2],array[e][3],IntervalId4);computer.x==internet.x&&computer.y==internet.y&&(clearInterval(IntervalId4),ctx.font="bold 35px Courier",ctx.fillStyle="white",ctx.textAlign="center",ctx.textBaseline="middle",ctx.fillText("#HackerMan",width/2,height/2-120),ctx.fillText("You snooped though all",width/2,height/2+45-120),ctx.fillText("the firewalls.",width/2,height/2+90-120),setTimeout(function(){showManual(),currentLevel=level5},2500)),ctx.strokeRect(0,0,width,height)},30)},level5=function(){currentLevel=level5,clearInterval($_inter),gameoverState=!1,array=[[80,50,30,160],[width-blocksize-100,height-blocksize-150,30,150],[170,220,30,160],[400,330,30,160],[285,200,30,80],[285,320,30,80],[225,420,30,80],[330,220,90,30],[80,380,30,160],[130,80,80,30],[135,540,80,30],[width-blocksize-100,50,30,160]],clearInterval(IntervalId4),walke=!1,enemyb.x=width/2,enemyb.y=blocksize,enemyr.x=width/2,enemyr.y=height-blocksize-20,computer.x=width-blocksize-20,internet.x=blocksize,computer.y=height-blocksize-20,internet.y=blocksize,IntervalId5=setInterval(function(){ctx.clearRect(0,0,width,height),drawBorder(),ctx.font="20px Courier",ctx.fillStyle="Yellow",ctx.textAlign="center",ctx.textBaseline="middle",ctx.fillText("Day-5",290,30),computer.draw("blue"),internet.draw("red"),enemyb.draw(),enemyb.checkcollision(IntervalId5),enemyr.draw(),enemyr.checkcollision(IntervalId5);for(var e=0;e<array.length;e++)wall.draw(array[e][0],array[e][1],array[e][2],array[e][3],"green");for(var e=0;e<array.length;e++)enemyb.wallcollision(array[e][0],array[e][1],array[e][2],array[e][3],IntervalId5),enemyr.wallcollision(array[e][0],array[e][1],array[e][2],array[e][3],IntervalId5);for(var e=0;e<array.length;e++)computer.checkcollision(array[e][0],array[e][1],array[e][2],array[e][3],IntervalId5),internet.checkcollision(array[e][0],array[e][1],array[e][2],array[e][3],IntervalId5);computer.x==internet.x&&computer.y==internet.y&&(clearInterval(IntervalId5),ctx.font="bold 35px Courier",ctx.fillStyle="white",ctx.textAlign="center",ctx.textBaseline="middle",ctx.fillText("You WON!!!!!!!",width/2,height/2-120),setTimeout(function(){window.location.reload()},5e3)),ctx.strokeRect(0,0,width,height)},30)};